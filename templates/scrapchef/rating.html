{% extends 'scrapchef/base.html' %}
{% load static %}

{% block content %}
  <div class="rating-page">
    <h2>You are rating {{ post.User.username }}â€™s postâ€¦</h2>

    {% if error %}
      <p class="error-text">{{ error }}</p>
    {% endif %}

    {% if user.is_authenticated %}
      <form method="post">
        {% csrf_token %}

        <!-- TASTE -->
        <div class="rating-section">
          <h3>Taste</h3>
          <div class="button-grid" data-category="taste">
            <button type="button" data-value="1">ğŸ‚ Peak Culinary Excellence</button>
            <button type="button" data-value="2">ğŸ˜‹ Surprisingly Edible</button>
            <button type="button" data-value="3">ğŸ½ï¸ Prison Cafeteria</button>
            <button type="button" data-value="4">ğŸ’€ Apocalypse Rations</button>
            <button type="button" data-value="5">â˜ ï¸ Satanâ€™s Leftovers</button>
          </div>
          <input type="hidden" name="taste">
        </div>

        <!-- STRUGGLE -->
        <div class="rating-section">
          <h3>Struggle Level</h3>
          <div class="button-grid" data-category="struggle">
            <button type="button" data-value="1">ğŸ‘¨â€ğŸ³ Gordon Ramsay Level</button>
            <button type="button" data-value="2">ğŸ¥« End of the Month Level</button>
            <button type="button" data-value="3">ğŸ§’ Victorian Child Level</button>
            <button type="button" data-value="4">ğŸª“ Medieval Peasant Level</button>
            <button type="button" data-value="5">ğŸ§Ÿâ€â™€ï¸ Great Depression Level</button>
          </div>
          <input type="hidden" name="struggle">
        </div>

        <!-- PREP -->
        <div class="rating-section">
          <h3>Ease of Preparation</h3>
          <div class="button-grid" data-category="prep">
            <button type="button" data-value="1">ğŸ¥„ (Super Easy)</button>
            <button type="button" data-value="2">ğŸ¥„ğŸ¥„ </button>
            <button type="button" data-value="3">ğŸ¥„ğŸ¥„ğŸ¥„ </button>
            <button type="button" data-value="4">ğŸ¥„ğŸ¥„ğŸ¥„ğŸ¥„ </button>
            <button type="button" data-value="5">ğŸ¥„ğŸ¥„ğŸ¥„ğŸ¥„ğŸ¥„ (Hard)</button>
          </div>
          <input type="hidden" name="prep">
        </div>

        <!-- SUBMIT -->
        <div class="submit-area">
          <button type="submit" class="rate-button">Rate</button>
        </div>
      </form>
    {% else %}
      <p>Please <a href="{% url 'scrapchef:login_view' %}">log in</a> to rate this post.</p>
    {% endif %}
  </div>

  <!-- JavaScript -->
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      document.querySelectorAll('.button-grid').forEach(group => {
        const inputName = group.getAttribute("data-category");
        group.querySelectorAll('button').forEach(button => {
          button.addEventListener('click', () => {
            group.querySelectorAll('button').forEach(btn => btn.classList.remove('selected'));
            button.classList.add('selected');
            document.querySelector(`input[name="${inputName}"]`).value = button.dataset.value;
          });
        });
      });
    });
  </script>

  <!-- Extra Styling for Error Message -->
  <style>
    .error-text {
      color: #c52c2c;
      font-weight: bold;
      margin-bottom: 20px;
      font-size: 16px;
      text-align: center;
    }
  </style>
{% endblock %}

